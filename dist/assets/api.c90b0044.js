/*! 
 Build based on gin-vue-admin 
 Time : 1678354544000 */
/* empty css             */import{E as e}from"./dialog.fa5df2a0.js";import"./overlay.257b737a.js";import{E as a}from"./pagination.e33d475f.js";/* empty css              */import"./tag.0bb54889.js";import{a as l,E as t}from"./select.0319208d.js";import"./scrollbar.561042ca.js";/* empty css               */import{E as o,a as u}from"./table-column.61571603.js";import"./checkbox.bcafce17.js";/* empty css                */import{E as i}from"./popover.60f34cfa.js";import{E as s,a as d}from"./form-item.b18f90c3.js";/* empty css               */import{g as r,d as p,a as n,u as c,c as m,b as v}from"./api.4929e5d2.js";import{t as f}from"./stringFun.1a90c7e7.js";import{W as b}from"./warningBar.b44e96f3.js";import{_ as g,r as h,o as y,c as _,d as j,e as V,w,V as k,aD as C,a2 as x,h as A,j as E,c1 as U,b as G,E as I,a1 as z,bi as P,bj as D}from"./index.12a9298d.js";import"./refs.b0cb2972.js";import"./isEqual.471ce309.js";import"./_Uint8Array.f5d85d65.js";import"./index.bf155b92.js";import"./index.f53077c2.js";import"./strings.e4f34ae9.js";import"./_initCloneObject.8371cae6.js";import"./dropdown.469739c6.js";/* empty css             */const S=e=>(P("data-v-bcd8c4e1"),e=e(),D(),e),T={class:"gva-search-box"},q=A("查询"),$=A("重置"),F={class:"gva-table-box"},B={class:"gva-btn-list"},O=A("新增"),K=S((()=>j("p",null,"确定要删除吗？",-1))),L={style:{"text-align":"right","margin-top":"8px"}},W=A("取消"),H=A("确定"),J=A("删除"),M=A("编辑"),N=A("删除"),Q={class:"gva-pagination"},R={class:"dialog-footer"},X=A("取 消"),Y=A("确 定"),Z={name:"Api"},ee=g(Object.assign(Z,{setup(g){const A=e=>{const a=S.value.filter((a=>a.value===e))[0];return a&&`${a.label}`},P=h([]),D=h({path:"",apiGroup:"",method:"",description:""}),S=h([{value:"POST",label:"创建",type:"success"},{value:"GET",label:"查看",type:""},{value:"PUT",label:"更新",type:"warning"},{value:"DELETE",label:"删除",type:"danger"}]),Z=h(""),ee=h({path:[{required:!0,message:"请输入api路径",trigger:"blur"}],apiGroup:[{required:!0,message:"请输入组名称",trigger:"blur"}],method:[{required:!0,message:"请选择请求方式",trigger:"blur"}],description:[{required:!0,message:"请输入api介绍",trigger:"blur"}]}),ae=h(1),le=h(0),te=h(10),oe=h([]),ue=h({}),ie=()=>{ue.value={}},se=()=>{ae.value=1,te.value=10,ne()},de=e=>{te.value=e,ne()},re=e=>{ae.value=e,ne()},pe=({prop:e,order:a})=>{e&&("ID"===e&&(e="id"),ue.value.orderKey=f(e),ue.value.desc="descending"===a),ne()},ne=async()=>{const e=await r({page:ae.value,pageSize:te.value,...ue.value});0===e.code&&(oe.value=e.data.list,le.value=e.data.total,ae.value=e.data.page,te.value=e.data.pageSize)};ne();const ce=e=>{P.value=e},me=h(!1),ve=async()=>{const e=P.value.map((e=>e.ID)),a=await p({ids:e});0===a.code&&(E({type:"success",message:a.msg}),oe.value.length===e.length&&ae.value>1&&ae.value--,me.value=!1,ne())},fe=h(null),be=h("新增Api"),ge=h(!1),he=e=>{switch(e){case"addApi":be.value="新增Api";break;case"edit":be.value="编辑Api"}Z.value=e,ge.value=!0},ye=()=>{fe.value.resetFields(),D.value={path:"",apiGroup:"",method:"",description:""},ge.value=!1},_e=async()=>{fe.value.validate((async e=>{if(e)switch(Z.value){case"addApi":0===(await m(D.value)).code&&E({type:"success",message:"添加成功",showClose:!0}),ne(),ye();break;case"edit":0===(await c(D.value)).code&&E({type:"success",message:"编辑成功",showClose:!0}),ne(),ye();break;default:E({type:"error",message:"未知操作",showClose:!0})}}))};return(r,p)=>{const c=G,m=s,f=t,g=l,h=I,Z=d,je=i,Ve=o,we=u,ke=a,Ce=e;return y(),_("div",null,[j("div",T,[V(Z,{ref:"searchForm",inline:!0,model:ue.value},{default:w((()=>[V(m,{label:"路径"},{default:w((()=>[V(c,{modelValue:ue.value.path,"onUpdate:modelValue":p[0]||(p[0]=e=>ue.value.path=e),placeholder:"路径"},null,8,["modelValue"])])),_:1}),V(m,{label:"描述"},{default:w((()=>[V(c,{modelValue:ue.value.description,"onUpdate:modelValue":p[1]||(p[1]=e=>ue.value.description=e),placeholder:"描述"},null,8,["modelValue"])])),_:1}),V(m,{label:"API组"},{default:w((()=>[V(c,{modelValue:ue.value.apiGroup,"onUpdate:modelValue":p[2]||(p[2]=e=>ue.value.apiGroup=e),placeholder:"api组"},null,8,["modelValue"])])),_:1}),V(m,{label:"请求"},{default:w((()=>[V(g,{modelValue:ue.value.method,"onUpdate:modelValue":p[3]||(p[3]=e=>ue.value.method=e),clearable:"",placeholder:"请选择"},{default:w((()=>[(y(!0),_(k,null,C(S.value,(e=>(y(),z(f,{key:e.value,label:`${e.label}(${e.value})`,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),V(m,null,{default:w((()=>[V(h,{type:"primary",icon:"search",onClick:se},{default:w((()=>[q])),_:1}),V(h,{icon:"refresh",onClick:ie},{default:w((()=>[$])),_:1})])),_:1})])),_:1},8,["model"])]),j("div",F,[j("div",B,[V(h,{type:"primary",icon:"plus",onClick:p[4]||(p[4]=e=>he("addApi"))},{default:w((()=>[O])),_:1}),V(je,{modelValue:me.value,"onUpdate:modelValue":p[7]||(p[7]=e=>me.value=e),placement:"top",width:"160"},{reference:w((()=>[V(h,{icon:"delete",disabled:!P.value.length,style:{"margin-left":"10px"},onClick:p[6]||(p[6]=e=>me.value=!0)},{default:w((()=>[J])),_:1},8,["disabled"])])),default:w((()=>[K,j("div",L,[V(h,{type:"primary",link:"",onClick:p[5]||(p[5]=e=>me.value=!1)},{default:w((()=>[W])),_:1}),V(h,{type:"primary",onClick:ve},{default:w((()=>[H])),_:1})])])),_:1},8,["modelValue"])]),V(we,{data:oe.value,onSortChange:pe,onSelectionChange:ce},{default:w((()=>[V(Ve,{type:"selection",width:"55"}),V(Ve,{align:"left",label:"id","min-width":"60",prop:"ID",sortable:"custom"}),V(Ve,{align:"left",label:"API路径","min-width":"150",prop:"path",sortable:"custom"}),V(Ve,{align:"left",label:"API分组","min-width":"150",prop:"apiGroup",sortable:"custom"}),V(Ve,{align:"left",label:"API简介","min-width":"150",prop:"description",sortable:"custom"}),V(Ve,{align:"left",label:"请求","min-width":"150",prop:"method",sortable:"custom"},{default:w((e=>[j("div",null,x(e.row.method)+" / "+x(A(e.row.method)),1)])),_:1}),V(Ve,{align:"left",fixed:"right",label:"操作",width:"200"},{default:w((e=>[V(h,{icon:"edit",type:"primary",link:"",onClick:a=>(async e=>{const a=await n({id:e.ID});D.value=a.data.api,he("edit")})(e.row)},{default:w((()=>[M])),_:2},1032,["onClick"]),V(h,{icon:"delete",type:"primary",link:"",onClick:a=>(async e=>{U.confirm("此操作将永久删除所有角色下该api, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((async()=>{0===(await v(e)).code&&(E({type:"success",message:"删除成功!"}),1===oe.value.length&&ae.value>1&&ae.value--,ne())}))})(e.row)},{default:w((()=>[N])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),j("div",Q,[V(ke,{"current-page":ae.value,"page-size":te.value,"page-sizes":[10,30,50,100],total:le.value,layout:"total, sizes, prev, pager, next, jumper",onCurrentChange:re,onSizeChange:de},null,8,["current-page","page-size","total"])])]),V(Ce,{modelValue:ge.value,"onUpdate:modelValue":p[12]||(p[12]=e=>ge.value=e),"before-close":ye,title:be.value},{footer:w((()=>[j("div",R,[V(h,{onClick:ye},{default:w((()=>[X])),_:1}),V(h,{type:"primary",onClick:_e},{default:w((()=>[Y])),_:1})])])),default:w((()=>[V(b,{title:"新增API，需要在角色管理内配置权限才可使用"}),V(Z,{ref_key:"apiForm",ref:fe,model:D.value,rules:ee.value,"label-width":"80px"},{default:w((()=>[V(m,{label:"路径",prop:"path"},{default:w((()=>[V(c,{modelValue:D.value.path,"onUpdate:modelValue":p[8]||(p[8]=e=>D.value.path=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),V(m,{label:"请求",prop:"method"},{default:w((()=>[V(g,{modelValue:D.value.method,"onUpdate:modelValue":p[9]||(p[9]=e=>D.value.method=e),placeholder:"请选择",style:{width:"100%"}},{default:w((()=>[(y(!0),_(k,null,C(S.value,(e=>(y(),z(f,{key:e.value,label:`${e.label}(${e.value})`,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),V(m,{label:"api分组",prop:"apiGroup"},{default:w((()=>[V(c,{modelValue:D.value.apiGroup,"onUpdate:modelValue":p[10]||(p[10]=e=>D.value.apiGroup=e),autocomplete:"off"},null,8,["modelValue"])])),_:1}),V(m,{label:"api简介",prop:"description"},{default:w((()=>[V(c,{modelValue:D.value.description,"onUpdate:modelValue":p[11]||(p[11]=e=>D.value.description=e),autocomplete:"off"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"])])),_:1},8,["modelValue","title"])])}}}),[["__scopeId","data-v-bcd8c4e1"]]);export{ee as default};
