/*! 
 Build based on gin-vue-admin 
 Time : 1678354544000 */
/* empty css             */import{E as e}from"./drawer.11294d2c.js";import"./overlay.257b737a.js";import{E as a}from"./pagination.e33d475f.js";/* empty css              */import{d as t}from"./tag.0bb54889.js";import"./select.0319208d.js";import"./scrollbar.561042ca.js";/* empty css               *//* empty css             */import{E as l,a as n}from"./form-item.b18f90c3.js";/* empty css               */import{_ as s,U as o,g as i,e as r}from"./common.0cfb4872.js";import{W as u}from"./warningBar.b44e96f3.js";import{m as c,aa as d,q as v,s as m,bl as p,ao as f,A as g,cr as y,cs as b,ct as w,aj as k,C as h,aZ as x,r as z,cu as C,al as _,z as I,D as O,W as j,Q as E,o as S,a1 as T,e as N,w as A,d as B,n as L,J as R,ai as Y,f as $,aw as V,b3 as U,c as X,bC as D,bD as M,V as F,cv as W,c4 as P,a4 as K,cw as H,cx as q,aD as Z,ag as G,ah as J,a3 as Q,I as ee,aE as ae,a$ as te,K as le,aI as ne,at as se,cy as oe,a6 as ie,cz as re,cA as ue,aY as ce,a2 as de,ab as ve,x as me,cB as pe,cC as fe,h as ge,c1 as ye,j as be,b as we,E as ke}from"./index.12a9298d.js";var he="Expected a function";function xe(e,a,l){var n=!0,s=!0;if("function"!=typeof e)throw new TypeError(he);return c(l)&&(n="leading"in l?!!l.leading:n,s="trailing"in l?!!l.trailing:s),t(e,a,{leading:n,maxWait:a,trailing:s})}const ze=(e,a)=>{if(!d||!e||!a)return!1;const t=e.getBoundingClientRect();let l;return l=a instanceof Element?a.getBoundingClientRect():{top:0,right:window.innerWidth,bottom:window.innerHeight,left:0},t.top<l.bottom&&t.bottom>l.top&&t.right>l.left&&t.left<l.right},Ce=v({urlList:{type:m(Array),default:()=>p([])},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},hideOnClickModal:{type:Boolean,default:!1},teleported:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),_e={close:()=>!0,switch:e=>f(e)},Ie=["src"],Oe=g({name:"ElImageViewer"});const je=ie(le(g({...Oe,props:Ce,emits:_e,setup(e,{expose:a,emit:t}){const l=e,n={CONTAIN:{name:"contain",icon:y(b)},ORIGINAL:{name:"original",icon:y(w)}},{t:s}=k(),o=h("image-viewer"),{nextZIndex:i}=x(),r=z(),u=z([]),c=C(),d=z(!0),v=z(l.initialIndex),m=_(n.CONTAIN),p=z({scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}),g=I((()=>{const{urlList:e}=l;return e.length<=1})),le=I((()=>0===v.value)),ie=I((()=>v.value===l.urlList.length-1)),re=I((()=>l.urlList[v.value])),ue=I((()=>{const{scale:e,deg:a,offsetX:t,offsetY:l,enableTransition:s}=p.value;let o=t/e,i=l/e;switch(a%360){case 90:case-270:[o,i]=[i,-o];break;case 180:case-180:[o,i]=[-o,-i];break;case 270:case-90:[o,i]=[-i,o]}const r={transform:`scale(${e}) rotate(${a}deg) translate(${o}px, ${i}px)`,transition:s?"transform .3s":""};return m.value.name===n.CONTAIN.name&&(r.maxWidth=r.maxHeight="100%"),r})),ce=I((()=>f(l.zIndex)?l.zIndex:i()));function de(){c.stop(),t("close")}function ve(){d.value=!1}function me(e){d.value=!1,e.target.alt=s("el.image.error")}function pe(e){if(d.value||0!==e.button||!r.value)return;p.value.enableTransition=!1;const{offsetX:a,offsetY:t}=p.value,l=e.pageX,n=e.pageY,s=xe((e=>{p.value={...p.value,offsetX:a+e.pageX-l,offsetY:t+e.pageY-n}})),o=ne(document,"mousemove",s);ne(document,"mouseup",(()=>{o()})),e.preventDefault()}function fe(){p.value={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}function ge(){if(d.value)return;const e=oe(n),a=Object.values(n),t=m.value.name,l=(a.findIndex((e=>e.name===t))+1)%e.length;m.value=n[e[l]],fe()}function ye(e){const a=l.urlList.length;v.value=(e+a)%a}function be(){le.value&&!l.infinite||ye(v.value-1)}function we(){ie.value&&!l.infinite||ye(v.value+1)}function ke(e,a={}){if(d.value)return;const{zoomRate:t,rotateDeg:n,enableTransition:s}={zoomRate:l.zoomRate,rotateDeg:90,enableTransition:!0,...a};switch(e){case"zoomOut":p.value.scale>.2&&(p.value.scale=Number.parseFloat((p.value.scale/t).toFixed(3)));break;case"zoomIn":p.value.scale<7&&(p.value.scale=Number.parseFloat((p.value.scale*t).toFixed(3)));break;case"clockwise":p.value.deg+=n;break;case"anticlockwise":p.value.deg-=n}p.value.enableTransition=s}return O(re,(()=>{j((()=>{const e=u.value[0];(null==e?void 0:e.complete)||(d.value=!0)}))})),O(v,(e=>{fe(),t("switch",e)})),E((()=>{var e,a;!function(){const e=xe((e=>{switch(e.code){case se.esc:l.closeOnPressEscape&&de();break;case se.space:ge();break;case se.left:be();break;case se.up:ke("zoomIn");break;case se.right:we();break;case se.down:ke("zoomOut")}})),a=xe((e=>{ke((e.deltaY||e.deltaX)<0?"zoomIn":"zoomOut",{zoomRate:l.zoomRate,enableTransition:!1})}));c.run((()=>{ne(document,"keydown",e),ne(document,"wheel",a)}))}(),null==(a=null==(e=r.value)?void 0:e.focus)||a.call(e)})),a({setActiveItem:ye}),(e,a)=>(S(),T(te,{to:"body",disabled:!e.teleported},[N(ae,{name:"viewer-fade",appear:""},{default:A((()=>[B("div",{ref_key:"wrapper",ref:r,tabindex:-1,class:L(R(o).e("wrapper")),style:Q({zIndex:R(ce)})},[B("div",{class:L(R(o).e("mask")),onClick:a[0]||(a[0]=Y((a=>e.hideOnClickModal&&de()),["self"]))},null,2),$(" CLOSE "),B("span",{class:L([R(o).e("btn"),R(o).e("close")]),onClick:de},[N(R(V),null,{default:A((()=>[N(R(U))])),_:1})],2),$(" ARROW "),R(g)?$("v-if",!0):(S(),X(F,{key:0},[B("span",{class:L([R(o).e("btn"),R(o).e("prev"),R(o).is("disabled",!e.infinite&&R(le))]),onClick:be},[N(R(V),null,{default:A((()=>[N(R(D))])),_:1})],2),B("span",{class:L([R(o).e("btn"),R(o).e("next"),R(o).is("disabled",!e.infinite&&R(ie))]),onClick:we},[N(R(V),null,{default:A((()=>[N(R(M))])),_:1})],2)],64)),$(" ACTIONS "),B("div",{class:L([R(o).e("btn"),R(o).e("actions")])},[B("div",{class:L(R(o).e("actions__inner"))},[N(R(V),{onClick:a[1]||(a[1]=e=>ke("zoomOut"))},{default:A((()=>[N(R(W))])),_:1}),N(R(V),{onClick:a[2]||(a[2]=e=>ke("zoomIn"))},{default:A((()=>[N(R(P))])),_:1}),B("i",{class:L(R(o).e("actions__divider"))},null,2),N(R(V),{onClick:ge},{default:A((()=>[(S(),T(K(R(m).icon)))])),_:1}),B("i",{class:L(R(o).e("actions__divider"))},null,2),N(R(V),{onClick:a[3]||(a[3]=e=>ke("anticlockwise"))},{default:A((()=>[N(R(H))])),_:1}),N(R(V),{onClick:a[4]||(a[4]=e=>ke("clockwise"))},{default:A((()=>[N(R(q))])),_:1})],2)],2),$(" CANVAS "),B("div",{class:L(R(o).e("canvas"))},[(S(!0),X(F,null,Z(e.urlList,((e,a)=>G((S(),X("img",{ref_for:!0,ref:e=>u.value[a]=e,key:e,src:e,style:Q(R(ue)),class:L(R(o).e("img")),onLoad:ve,onError:me,onMousedown:pe},null,46,Ie)),[[J,a===v.value]]))),128))],2),ee(e.$slots,"default")],6)])),_:3})],8,["disabled"]))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image-viewer/src/image-viewer.vue"]])),Ee=v({hideOnClickModal:{type:Boolean,default:!1},src:{type:String,default:""},fit:{type:String,values:["","contain","cover","fill","none","scale-down"],default:""},loading:{type:String,values:["eager","lazy"]},lazy:{type:Boolean,default:!1},scrollContainer:{type:m([String,Object])},previewSrcList:{type:m(Array),default:()=>p([])},previewTeleported:{type:Boolean,default:!1},zIndex:{type:Number},initialIndex:{type:Number,default:0},infinite:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},zoomRate:{type:Number,default:1.2}}),Se={load:e=>e instanceof Event,error:e=>e instanceof Event,switch:e=>f(e),close:()=>!0,show:()=>!0},Te=["src","loading"],Ne={key:0},Ae=g({name:"ElImage",inheritAttrs:!1});const Be=ie(le(g({...Ae,props:Ee,emits:Se,setup(e,{emit:a}){const t=e;let l="";const{t:n}=k(),s=h("image"),o=re(),i=ue(),r=z(),u=z(!1),c=z(!0),v=z(!1),m=z(),p=z(),f=d&&"loading"in HTMLImageElement.prototype;let g,y;const b=I((()=>o.style)),w=I((()=>{const{fit:e}=t;return d&&e?{objectFit:e}:{}})),x=I((()=>{const{previewSrcList:e}=t;return Array.isArray(e)&&e.length>0})),C=I((()=>{const{previewSrcList:e,initialIndex:a}=t;let l=a;return a>e.length-1&&(l=0),l})),_=I((()=>"eager"!==t.loading&&(!f&&"lazy"===t.loading||t.lazy))),N=()=>{d&&(c.value=!0,u.value=!1,r.value=t.src)};function Y(e){c.value=!1,u.value=!1,a("load",e)}function V(e){c.value=!1,u.value=!0,a("error",e)}function U(){ze(m.value,p.value)&&(N(),W())}const D=fe(U,200);async function M(){var e;if(!d)return;await j();const{scrollContainer:a}=t;ve(a)?p.value=a:me(a)&&""!==a?p.value=null!=(e=document.querySelector(a))?e:void 0:m.value&&(p.value=pe(m.value)),p.value&&(g=ne(p,"scroll",D),setTimeout((()=>U()),100))}function W(){d&&p.value&&D&&(null==g||g(),p.value=void 0)}function P(e){if(e.ctrlKey)return e.deltaY<0||e.deltaY>0?(e.preventDefault(),!1):void 0}function K(){x.value&&(y=ne("wheel",P,{passive:!1}),l=document.body.style.overflow,document.body.style.overflow="hidden",v.value=!0,a("show"))}function H(){null==y||y(),document.body.style.overflow=l,v.value=!1,a("close")}function q(e){a("switch",e)}return O((()=>t.src),(()=>{_.value?(c.value=!0,u.value=!1,W(),M()):N()})),E((()=>{_.value?M():N()})),(e,a)=>(S(),X("div",{ref_key:"container",ref:m,class:L([R(s).b(),e.$attrs.class]),style:Q(R(b))},[void 0===r.value||u.value?$("v-if",!0):(S(),X("img",ce({key:0},R(i),{src:r.value,loading:e.loading,style:R(w),class:[R(s).e("inner"),R(x)&&R(s).e("preview"),c.value&&R(s).is("loading")],onClick:K,onLoad:Y,onError:V}),null,16,Te)),c.value||u.value?(S(),X("div",{key:1,class:L(R(s).e("wrapper"))},[c.value?ee(e.$slots,"placeholder",{key:0},(()=>[B("div",{class:L(R(s).e("placeholder"))},null,2)])):u.value?ee(e.$slots,"error",{key:1},(()=>[B("div",{class:L(R(s).e("error"))},de(R(n)("el.image.error")),3)])):$("v-if",!0)],2)):$("v-if",!0),R(x)?(S(),X(F,{key:2},[v.value?(S(),T(R(je),{key:0,"z-index":e.zIndex,"initial-index":R(C),infinite:e.infinite,"zoom-rate":e.zoomRate,"url-list":e.previewSrcList,"hide-on-click-modal":e.hideOnClickModal,teleported:e.previewTeleported,"close-on-press-escape":e.closeOnPressEscape,onClose:H,onSwitch:q},{default:A((()=>[e.$slots.viewer?(S(),X("div",Ne,[ee(e.$slots,"viewer")])):$("v-if",!0)])),_:3},8,["z-index","initial-index","infinite","zoom-rate","url-list","hide-on-click-modal","teleported","close-on-press-escape"])):$("v-if",!0)],64)):$("v-if",!0)],6))}}),[["__file","/home/runner/work/element-plus/element-plus/packages/components/image/src/image.vue"]])),Le={class:"gva-btn-list"},Re=ge("查询"),Ye={class:"media"},$e={class:"header-img-box-list"},Ve={class:"header-img-box-list"},Ue=B("picture",null,null,-1),Xe=["onClick"],De={__name:"index",props:{target:{type:Object,default:null},targetKey:{type:String,default:""}},emits:["enterImg"],setup(t,{expose:c,emit:d}){const v=z(""),m=z(""),p=z({}),f=z(1),g=z(0),y=z(20),b=e=>{y.value=e,C()},w=e=>{f.value=e,C()},k=z(!1),h=z([]),x=z("/api/"),C=async()=>{const e=await i({page:f.value,pageSize:y.value,...p.value});0===e.code&&(h.value=e.data.list,g.value=e.data.total,f.value=e.data.page,y.value=e.data.pageSize,k.value=!0)};return c({open:C}),(i,c)=>{const z=we,_=l,I=ke,O=n,j=V,E=Be,L=a,R=e;return S(),T(R,{modelValue:k.value,"onUpdate:modelValue":c[3]||(c[3]=e=>k.value=e),title:"媒体库",size:"650px"},{default:A((()=>[N(u,{title:"点击“文件名/备注”可以编辑文件名或者备注内容。"}),B("div",Le,[N(s,{imageCommon:m.value,"onUpdate:imageCommon":c[0]||(c[0]=e=>m.value=e),class:"upload-btn-media-library",onOnSuccess:C},null,8,["imageCommon"]),N(o,{imageUrl:v.value,"onUpdate:imageUrl":c[1]||(c[1]=e=>v.value=e),"file-size":512,"max-w-h":1080,class:"upload-btn-media-library",onOnSuccess:C},null,8,["imageUrl"]),N(O,{ref:"searchForm",inline:!0,model:p.value},{default:A((()=>[N(_,{label:""},{default:A((()=>[N(z,{modelValue:p.value.keyword,"onUpdate:modelValue":c[2]||(c[2]=e=>p.value.keyword=e),class:"keyword",placeholder:"请输入文件名或备注"},null,8,["modelValue"])])),_:1}),N(_,null,{default:A((()=>[N(I,{type:"primary",icon:"search",onClick:C},{default:A((()=>[Re])),_:1})])),_:1})])),_:1},8,["model"])]),B("div",Ye,[(S(!0),X(F,null,Z(h.value,((e,a)=>(S(),X("div",{key:a,class:"media-box"},[B("div",$e,[(S(),T(E,{key:a,src:e.url&&"http"!==e.url.slice(0,4)?x.value+e.url:e.url,onClick:a=>{return l=e.url,n=t.target,s=t.targetKey,n&&s&&(n[s]=l),d("enterImg",l),void(k.value=!1);var l,n,s}},{error:A((()=>[B("div",Ve,[N(j,null,{default:A((()=>[Ue])),_:1})])])),_:2},1032,["src","onClick"]))]),B("div",{class:"img-title",onClick:a=>(async e=>{ye.prompt("请输入文件名或者备注","编辑",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/\S/,inputErrorMessage:"不能为空",inputValue:e.name}).then((async({value:a})=>{e.name=a,0===(await r(e)).code&&(be({type:"success",message:"编辑成功!"}),C())})).catch((()=>{be({type:"info",message:"取消修改"})}))})(e)},de(e.name),9,Xe)])))),128))]),N(L,{"current-page":f.value,"page-size":y.value,total:g.value,style:{"justify-content":"center"},layout:"total, prev, pager, next, jumper",onCurrentChange:w,onSizeChange:b},null,8,["current-page","page-size","total"])])),_:1},8,["modelValue"])}}};export{De as _};
