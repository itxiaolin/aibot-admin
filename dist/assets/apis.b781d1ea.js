/*! 
 Build based on gin-vue-admin 
 Time : 1678354544000 */
/* empty css             */import{E as a}from"./tree.19ffdddf.js";import"./checkbox.bcafce17.js";/* empty css               *//* empty css              */import{e}from"./api.4929e5d2.js";import{aK as t,_ as s,r as o,D as r,o as d,c,d as i,e as n,w as l,h as p,j as u,b as h,E as f}from"./index.12a9298d.js";import"./index.b753be06.js";import"./isEqual.471ce309.js";import"./_Uint8Array.f5d85d65.js";const m={class:"clearfix sticky-button"},y=p("确 定"),v={class:"tree-content"},b={name:"Apis"},j=s(Object.assign(b,{props:{row:{default:function(){return{}},type:Object}},setup(s,{expose:p}){const b=s,j=o({children:"children",label:"description"}),k=o(""),x=o([]),I=o([]),w=o("");(async()=>{const a=(await e()).data.apis;x.value=O(a);const s=await(o={authorityId:b.row.authorityId},t({url:"/casbin/getPolicyPathByAuthorityId",method:"post",data:o}));var o;w.value=b.row.authorityId,I.value=[],s.data.paths&&s.data.paths.forEach((a=>{I.value.push("p:"+a.path+"m:"+a.method)}))})();const g=o(!1),E=()=>{g.value=!0},O=a=>{const e={};a&&a.forEach((a=>{a.onlyId="p:"+a.path+"m:"+a.method,Object.prototype.hasOwnProperty.call(e,a.apiGroup)?e[a.apiGroup].push(a):Object.assign(e,{[a.apiGroup]:[a]})}));const t=[];for(const s in e){const a={ID:s,description:s+"组",children:e[s]};t.push(a)}return t},_=o(null),C=async()=>{const a=_.value.getCheckedNodes(!0);var e=[];a&&a.forEach((a=>{var t={path:a.path,method:a.method};e.push(t)}));var s;0===(await(s={authorityId:w.value,casbinInfos:e},t({url:"/casbin/updateCasbin",method:"post",data:s}))).code&&u({type:"success",message:"api设置成功"})};p({needConfirm:g,enterAndNext:()=>{C()}});const A=(a,e)=>!a||-1!==e.description.indexOf(a);return r(k,(a=>{_.value.filter(a)})),(e,t)=>{const s=h,o=f,r=a;return d(),c("div",null,[i("div",m,[n(s,{modelValue:k.value,"onUpdate:modelValue":t[0]||(t[0]=a=>k.value=a),class:"fitler",placeholder:"筛选"},null,8,["modelValue"]),n(o,{class:"fl-right",type:"primary",onClick:C},{default:l((()=>[y])),_:1})]),i("div",v,[n(r,{ref_key:"apiTree",ref:_,data:x.value,"default-checked-keys":I.value,props:j.value,"default-expand-all":"","highlight-current":"","node-key":"onlyId","show-checkbox":"","filter-node-method":A,onCheck:E},null,8,["data","default-checked-keys","props"])])])}}}),[["__scopeId","data-v-cad82bd2"]]);export{j as default};
